
import tkinter as tk
from tkinter import filedialog, messagebox
from core import datasheet_importer
from db.database import save_dataframe

def import_datasheet():
    file_path = filedialog.askopenfilename(
        title="Select Datasheet",
        filetypes=[("Supported files", "*.csv *.xls *.xlsx *.pdf *.txt *.png *.jpg *.jpeg")]
    )
    if not file_path:
        return

    try:
        tables = datasheet_importer.ingest_file(file_path)
        for name, df in tables:
            save_dataframe(df, datasheet_importer.slugify(name))
        messagebox.showinfo("Success", f"Imported {len(tables)} table(s) from {file_path}")
    except Exception as e:
        messagebox.showerror("Error", str(e))

# Example button
def build_gui():
    root = tk.Tk()
    root.title("Inventory Manager")
    import_btn = tk.Button(root, text="Import Datasheet", command=import_datasheet)
    import_btn.pack(pady=10)
    root.mainloop()


thinking of implenting it to gui
